<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HEXAGES GAMES | Şifre Protokolü</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <style>
        body { 
            background-color: #050505; 
            color: white; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            height: 100vh; 
            margin: 0; 
            overflow: hidden; 
        }
        /* Launcher'daki animated-border-box efekti */
        .card { 
            background: #09090b; 
            padding: 40px; 
            border-radius: 40px; 
            border: 1px solid #1a1a1a; 
            text-align: center; 
            box-shadow: 0 0 60px rgba(124, 58, 237, 0.15); 
            width: 100%; 
            max-width: 380px;
            position: relative;
        }
        .logo { 
            font-weight: 900; 
            font-style: italic; 
            letter-spacing: 0.4em; 
            color: #ffffff; 
            margin-bottom: 25px; 
            font-size: 20px; 
            text-transform: uppercase;
        }
        h2 {
            font-size: 14px;
            font-weight: 900;
            text-transform: uppercase;
            font-style: italic;
            letter-spacing: 0.1em;
            color: #7C3AED;
            margin-bottom: 20px;
        }
        input { 
            width: 100%; 
            padding: 16px; 
            margin: 10px 0; 
            background: rgba(255,255,255,0.04); 
            border: 1px solid rgba(255,255,255,0.1); 
            color: white; 
            border-radius: 16px; 
            outline: none; 
            box-sizing: border-box; 
            font-size: 12px;
            transition: border-color 0.3s;
        }
        input:focus { border-color: #7C3AED; }
        button { 
            background: #7C3AED; 
            color: white; 
            border: none; 
            padding: 16px; 
            width: 100%; 
            border-radius: 16px; 
            font-weight: 900; 
            cursor: pointer; 
            text-transform: uppercase; 
            letter-spacing: 0.2em; 
            font-style: italic;
            margin-top: 10px;
            transition: transform 0.2s, background 0.2s;
        }
        button:hover { background: #6D28D9; transform: scale(1.02); }
        #message { 
            margin-top: 20px; 
            font-size: 11px; 
            font-weight: bold;
            color: #a1a1aa; 
            text-transform: uppercase;
            letter-spacing: 0.1em;
            line-height: 1.5;
        }
        .success { color: #22c55e !important; }
        .error { color: #ef4444 !important; }
    </style>
</head>
<body>
    <div class="card">
        <div class="logo">HEXAGES GAMES</div>
        <h2>GÜVENLİK ANAHTARI YENİLEME</h2>
        
        <div id="form-container">
            <input type="password" id="new-password" placeholder="YENİ GÜVENLİK ANAHTARI">
            <button onclick="handleReset()">SİSTEMİ GÜNCELLE</button>
        </div>
        
        <p id="message">BAĞLANTI DOĞRULANIYOR...</p>
    </div>

    <script>
        // Senin paylaştığın API bilgileri eklendi
        const firebaseConfig = {
            apiKey: "AIzaSyAroBTexiXeaJGYqMiIIM5POdN2JUuigvo",
            authDomain: "hexagesgames-f8fe2.firebaseapp.com",
            projectId: "hexagesgames-f8fe2",
            storageBucket: "hexagesgames-f8fe2.firebasestorage.app",
            messagingSenderId: "469976981538",
            appId: "1:469976981538:web:c5b49c15b0206c7fb76a7b",
            measurementId: "G-6E33GJ0ZB0"
        };
        
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        const urlParams = new URLSearchParams(window.location.search);
        const mode = urlParams.get('mode');
        const actionCode = urlParams.get('oobCode');

        const msgElement = document.getElementById('message');
        const formContainer = document.getElementById('form-container');

        // Sayfa yüklendiğinde linkin geçerliliğini kontrol et
        if (mode === 'resetPassword' && actionCode) {
            auth.verifyPasswordResetCode(actionCode).then((email) => {
                msgElement.innerText = email + " HESABI İÇİN YENİ ŞİFRE BELİRLEYİN.";
            }).catch((error) => {
                msgElement.innerText = "BAĞLANTI GEÇERSİZ VEYA SÜRESİ DOLMUŞ.";
                msgElement.classList.add('error');
                formContainer.style.display = 'none';
            });
        } else {
            msgElement.innerText = "GEÇERSİZ ERİŞİM PROTOKOLÜ.";
            formContainer.style.display = 'none';
        }

        async function handleReset() {
            const newPassword = document.getElementById('new-password').value;

            if (newPassword.length < 6) {
                msgElement.innerText = "ŞİFRE EN AZ 6 KARAKTER OLMALIDIR.";
                msgElement.classList.add('error');
                return;
            }

            msgElement.innerText = "ŞİFRE GÜNCELLENİYOR...";
            msgElement.classList.remove('error');

            try {
                await auth.confirmPasswordReset(actionCode, newPassword);
                msgElement.innerHTML = "<span class='success'>PROTOKOL TAMAMLANDI!</span><br><br>ŞİFRENİZ GÜNCELLENDİ. LAUNCHER'A DÖNÜP GİRİŞ YAPABİLİRSİNİZ.";
                formContainer.style.display = 'none';
            } catch (error) {
                msgElement.innerText = "HATA: " + error.message;
                msgElement.classList.add('error');
            }
        }
    </script>
</body>
</html>
