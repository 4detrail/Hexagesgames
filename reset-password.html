<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HEXAGES | Secure Protocol</title>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <style>
        :root { --primary: #7C3AED; --bg: #050505; --card-bg: #09090b; }
        body { background-color: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; }

        /* Arka Plan Kar Animasyonu */
        .snow { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; }
        .snowflake { position: absolute; background: white; border-radius: 50%; opacity: 0.3; animation: fall linear infinite; }
        @keyframes fall { to { transform: translateY(105vh) translateX(20px); } }

        /* Hareketli Kenarlık Efekti */
        .outer-card { position: relative; padding: 2px; border-radius: 40px; overflow: hidden; z-index: 10; width: 100%; max-width: 400px; animation: fadeIn 1s ease-out; }
        .outer-card::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: conic-gradient(transparent, transparent, transparent, var(--primary)); animation: rotate 4s linear infinite; }
        @keyframes rotate { 100% { transform: rotate(360deg); } }

        .card { position: relative; background: var(--card-bg); padding: 50px 40px; border-radius: 38px; text-align: center; z-index: 11; }
        
        .logo { font-weight: 900; font-style: italic; letter-spacing: 0.5em; color: #ffffff; margin-bottom: 30px; font-size: 22px; text-transform: uppercase; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }

        h2 { font-size: 12px; font-weight: 900; text-transform: uppercase; font-style: italic; letter-spacing: 0.2em; color: var(--primary); margin-bottom: 25px; }

        input { width: 100%; padding: 16px; margin: 10px 0; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: white; border-radius: 16px; outline: none; box-sizing: border-box; font-size: 12px; transition: 0.3s; }
        input:focus { border-color: var(--primary); background: rgba(255,255,255,0.08); box-shadow: 0 0 15px rgba(124, 58, 237, 0.2); }

        button { background: var(--primary); color: white; border: none; padding: 18px; width: 100%; border-radius: 18px; font-weight: 900; cursor: pointer; text-transform: uppercase; letter-spacing: 0.3em; font-style: italic; margin-top: 15px; transition: 0.3s; box-shadow: 0 10px 20px rgba(124, 58, 237, 0.3); }
        button:hover { background: #6D28D9; transform: translateY(-2px); box-shadow: 0 15px 25px rgba(124, 58, 237, 0.4); }
        button:active { transform: translateY(0); }

        #message { margin-top: 25px; font-size: 10px; font-weight: bold; color: #666; text-transform: uppercase; letter-spacing: 0.1em; line-height: 1.6; }
        .success { color: #22c55e !important; }
        .error { color: #ef4444 !important; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

    <div class="snow" id="snow"></div>

    <div class="outer-card">
        <div class="card">
            <div class="logo">HEXAGES GAMES</div>
            <h2>ŞİFRE YENİLEME PROTOKOLÜ</h2>
            
            <div id="form-container">
                <input type="password" id="new-password" placeholder="YENİ GÜVENLİK ANAHTARI">
                <button onclick="handleReset()">SİSTEMİ GÜNCELLE</button>
            </div>
            
            <p id="message">BAĞLANTI DOĞRULANIYOR...</p>
        </div>
    </div>

    <script>
        // Kar Efekti Oluşturucu
        const snowContainer = document.getElementById('snow');
        for (let i = 0; i < 50; i++) {
            const flake = document.createElement('div');
            flake.className = 'snowflake';
            flake.style.width = flake.style.height = Math.random() * 4 + 2 + 'px';
            flake.style.left = Math.random() * 100 + '%';
            flake.style.top = '-5%';
            flake.style.animationDuration = Math.random() * 5 + 5 + 's';
            flake.style.animationDelay = Math.random() * 5 + 's';
            snowContainer.appendChild(flake);
        }

        // Firebase Yapılandırması
        const firebaseConfig = {
            apiKey: "AIzaSyAroBTexiXeaJGYqMiIIM5POdN2JUuigvo",
            authDomain: "hexagesgames-f8fe2.firebaseapp.com",
            projectId: "hexagesgames-f8fe2",
            storageBucket: "hexagesgames-f8fe2.firebasestorage.app",
            messagingSenderId: "469976981538",
            appId: "1:469976981538:web:c5b49c15b0206c7fb76a7b",
            measurementId: "G-6E33GJ0ZB0"
        };
        
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();

        const urlParams = new URLSearchParams(window.location.search);
        const mode = urlParams.get('mode');
        const actionCode = urlParams.get('oobCode');

        const msgElement = document.getElementById('message');
        const formContainer = document.getElementById('form-container');

        if (mode === 'resetPassword' && actionCode) {
            auth.verifyPasswordResetCode(actionCode).then((email) => {
                msgElement.innerText = email + " İÇİN ERİŞİM ONAYLANDI. YENİ ANAHTAR GİRİN.";
            }).catch((error) => {
                msgElement.innerText = "GEÇERSİZ VEYA SÜRESİ DOLMUŞ PROTOKOL.";
                msgElement.classList.add('error');
                formContainer.style.display = 'none';
            });
        } else {
            msgElement.innerText = "GEÇERSİZ ERİŞİM PROTOKOLÜ. LÜTFEN LAUNCHER'DAN SİSTEMİ TEKRAR DENEYİN.";
            formContainer.style.display = 'none';
        }

        async function handleReset() {
            const newPassword = document.getElementById('new-password').value;
            if (newPassword.length < 6) {
                msgElement.innerText = "ŞİFRE EN AZ 6 KARAKTER OLMALIDIR.";
                msgElement.classList.add('error');
                return;
            }

            msgElement.innerText = "VERİLER GÜNCELLENİYOR...";
            try {
                await auth.confirmPasswordReset(actionCode, newPassword);
                msgElement.innerHTML = "<span class='success'>PROTOKOL BAŞARIYLA TAMAMLANDI!</span><br><br>YENİ ANAHTAR AKTİF. ŞİMDİ LAUNCHER'A DÖNEBİLİRSİNİZ.";
                formContainer.style.display = 'none';
            } catch (error) {
                msgElement.innerText = "KRİTİK HATA: " + error.message;
                msgElement.classList.add('error');
            }
        }
    </script>
</body>
</html>
